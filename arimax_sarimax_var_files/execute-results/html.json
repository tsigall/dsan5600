{
  "hash": "7b33c4c7b24ac859bf18da8bc94486c0",
  "result": {
    "markdown": "---\ntitle: \"ARIMAX/SARIMAX/VAR\"\neditor_options: \n  chunk_output_type: inline\nbibliography: reference.bib\n---\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n# Exogenous Variables\n\nThe number of arrests made in any city, especially one as large and diverse as New York City, is a figure that is influenced by many variables in addition to time. This means that modelling the number of arrests only on time may result in overlooking valuable information that could be used to fit a model that could forecast arrests even more accurately. Similar work has been done in the past, relating both the economy and labor markets to crime statistics.\n\nWe will take that approach here, drawing inspiration on the work mentioned in the introduction by Freeman in which he looks at \"the way decisions interact in a market setting\" [@freeman_chapter_1999]. He exhibits an important understanding of the influence economic factors have on crime, treating crime rates as another variable in our complex economic system. Looking at the labor market would be beneficial as well, as in the 1980's and 90's crime was seen to be closely related to unemployment rates [@gould_crime_2002].\n\nAnother variable that might be useful to look at is the state of the current election cycle. It is possible that when public officials are up for re-election, they might be more incentivized to take more action to lower crime rates.\n\n# Models to Fit\n\nTwo types of models will be fit here. We will use an ARIMAX or SARIMAX model when looking at the effect of one or more exogenous variables in predicting the number of arrests. We will use a VAR model when looking at how crime and other time series variables are influenced by each other. The specific models are listed below:\n\n-   (ARIMAX) Total Arrests \\~ Unemployment Rate\n\n-   (ARIMAX) Total Arrests \\~ Election Year\n\n-   (ARIMAX) Murder \\~ Unemployment Rate + GDP\n\n-   (VAR) Robbery \\~ Unemployment Rate\n\n-   (VAR) Controlled Substance Possession \\~ Marijuana Possession\n\n## Total Arrests ~ Unemployment Rate\n\nWe have a univariate time series in total arrests and we want to see the effect the exogenous variable of unemployment rate has on that time series. We will fit an ARIMAX model, Total Arrests \\~ Unemployment Rate. Unemployment data is for the New York City Metropolitan Area and obtained from [here](https://fred.stlouisfed.org/categories/30789).\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:right;\"> arrests </th>\n   <th style=\"text-align:right;\"> unrate </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-01-01 </td>\n   <td style=\"text-align:right;\"> 31161 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-02-01 </td>\n   <td style=\"text-align:right;\"> 28962 </td>\n   <td style=\"text-align:right;\"> 5.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-03-01 </td>\n   <td style=\"text-align:right;\"> 34014 </td>\n   <td style=\"text-align:right;\"> 4.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-04-01 </td>\n   <td style=\"text-align:right;\"> 30636 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-05-01 </td>\n   <td style=\"text-align:right;\"> 32368 </td>\n   <td style=\"text-align:right;\"> 4.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-06-01 </td>\n   <td style=\"text-align:right;\"> 30540 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nThere looks to be some relation between these two variables, with the spike in 2020 in unemployment rate being at the same time as the low arrest rate, though we should fit a model to see if this relationship is substantial.\n\n### Fitting Using auto.arima\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nSeries: dd.ts[, \"arrests\"] \nRegression with ARIMA(0,1,2)(2,0,0)[12] errors \n\nCoefficients:\n          ma1      ma2    sar1    sar2       xreg\n      -0.4433  -0.2617  0.4377  0.3516  -415.3528\ns.e.   0.0716   0.0717  0.0636  0.0664   104.6520\n\nsigma^2 = 3278067:  log likelihood = -1813.8\nAIC=3639.59   AICc=3640.02   BIC=3659.47\n\nTraining set error measures:\n                    ME     RMSE      MAE        MPE     MAPE      MASE\nTraining set -72.90552 1783.719 1245.697 -0.4868256 5.528259 0.4816615\n                    ACF1\nTraining set -0.02051394\n```\n:::\n\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tLjung-Box test\n\ndata:  Residuals from Regression with ARIMA(0,1,2)(2,0,0)[12] errors\nQ* = 23.864, df = 20, p-value = 0.2484\n\nModel df: 4.   Total lags used: 24\n```\n:::\n:::\n\n\nWe have a SARIMAX model, a regression model with ARIMA(0,1,2)(2,0,0)\\[12\\] errors.\n\n### Fitting Manually\n\nWe first fit a linear regression model predicting arrests using unemployment rate. The we will fit an ARIMA/SARIMA model for the residuals.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = arrests ~ unrate, data = dd)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-22923  -6217   2578   6683  11433 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  24364.8     1627.5  14.971   <2e-16 ***\nunrate         409.5      240.4   1.704     0.09 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8306 on 202 degrees of freedom\nMultiple R-squared:  0.01416,\tAdjusted R-squared:  0.009283 \nF-statistic: 2.902 on 1 and 202 DF,  p-value: 0.09\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nres.fit <- ts(residuals(fit.reg), start = c(2006, 1), frequency = 12)\nggtsdisplay(res.fit)\n```\n\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggtsdisplay(res.fit %>% diff())\n```\n\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggtsdisplay(res.fit %>% diff() %>% diff(12))\n```\n\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n:::\n\n\nWe will try the following parameters:\n\n-   p: 1, 4\n-   d: 0, 1\n-   q: 1, 4\n-   P: 1\n-   D: 0, 1\n-   Q: 1, 2, 3\n\n\n::: {.cell}\n\n:::\n\n\n### Model Selection and Diagnostics\n\n#### Minimum AIC\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> p </th>\n   <th style=\"text-align:right;\"> d </th>\n   <th style=\"text-align:right;\"> q </th>\n   <th style=\"text-align:right;\"> P </th>\n   <th style=\"text-align:right;\"> D </th>\n   <th style=\"text-align:right;\"> Q </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> AICc </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3439.632 </td>\n   <td style=\"text-align:right;\"> 3462.398 </td>\n   <td style=\"text-align:right;\"> 3440.244 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Minimum BIC\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> p </th>\n   <th style=\"text-align:right;\"> d </th>\n   <th style=\"text-align:right;\"> q </th>\n   <th style=\"text-align:right;\"> P </th>\n   <th style=\"text-align:right;\"> D </th>\n   <th style=\"text-align:right;\"> Q </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> AICc </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 8 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3439.95 </td>\n   <td style=\"text-align:right;\"> 3456.211 </td>\n   <td style=\"text-align:right;\"> 3440.274 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Minimum AICc\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> p </th>\n   <th style=\"text-align:right;\"> d </th>\n   <th style=\"text-align:right;\"> q </th>\n   <th style=\"text-align:right;\"> P </th>\n   <th style=\"text-align:right;\"> D </th>\n   <th style=\"text-align:right;\"> Q </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> AICc </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 12 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3439.632 </td>\n   <td style=\"text-align:right;\"> 3462.398 </td>\n   <td style=\"text-align:right;\"> 3440.244 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nIt is clear that the best model is one with parameters $p=1, d=1, q=1, P=1, D=1, Q=3$. We now check the model diagnostics.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nThe Ljung-Box statistic p-values suggest that there is no correlation between residuals, meaning we have a good enough model. We will proceed with the model SARIMA(1, 1, 1)(1, 1, 2)12. The information criteria are all similar between the auto model and this model. We will proceed with this model. \n\n#### Fitted vs. Actual\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n### Cross Validation\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nWarning in window.default(x, ...): 'end' value not changed\n\nWarning in window.default(x, ...): 'end' value not changed\n\nWarning in window.default(x, ...): 'end' value not changed\n\nWarning in window.default(x, ...): 'end' value not changed\n\nWarning in window.default(x, ...): 'end' value not changed\n\nWarning in window.default(x, ...): 'end' value not changed\n\nWarning in window.default(x, ...): 'end' value not changed\n\nWarning in window.default(x, ...): 'end' value not changed\n\nWarning in window.default(x, ...): 'end' value not changed\n\nWarning in window.default(x, ...): 'end' value not changed\n\nWarning in window.default(x, ...): 'end' value not changed\n```\n:::\n\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n### Forecasting\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n## Total Arrests \\~ Election Year\n\n## Murder \\~ Unemployment Rate\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:right;\"> murder </th>\n   <th style=\"text-align:right;\"> unrate </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-01-01 </td>\n   <td style=\"text-align:right;\"> 90 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-02-01 </td>\n   <td style=\"text-align:right;\"> 56 </td>\n   <td style=\"text-align:right;\"> 5.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-03-01 </td>\n   <td style=\"text-align:right;\"> 74 </td>\n   <td style=\"text-align:right;\"> 4.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-04-01 </td>\n   <td style=\"text-align:right;\"> 84 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-05-01 </td>\n   <td style=\"text-align:right;\"> 74 </td>\n   <td style=\"text-align:right;\"> 4.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-06-01 </td>\n   <td style=\"text-align:right;\"> 79 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\nThere looks to be some relation between these two variables, though we should fit a model to see if this relationship is substantial.\n\n### Fitting Using auto.arima\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nSeries: dd.ts[, \"murder\"] \nRegression with ARIMA(0,1,1) errors \n\nCoefficients:\n          ma1     xreg\n      -0.7259  -0.4942\ns.e.   0.0674   0.9076\n\nsigma^2 = 280.1:  log likelihood = -859.4\nAIC=1724.8   AICc=1724.92   BIC=1734.74\n\nTraining set error measures:\n                   ME     RMSE      MAE       MPE     MAPE     MASE       ACF1\nTraining set 1.041573 16.61411 12.66717 -2.430242 15.61884 0.696676 0.05569138\n```\n:::\n\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tLjung-Box test\n\ndata:  Residuals from Regression with ARIMA(0,1,1) errors\nQ* = 49.231, df = 23, p-value = 0.001161\n\nModel df: 1.   Total lags used: 24\n```\n:::\n:::\n\n\nWe have an ARIMAX model, a regression model with ARIMA(0,1,1) errors.\n\n### Fitting Manually\n\nWe first fit a linear regression model predicting arrests using unemployment rate. The we will fit an ARIMA/SARIMA model for the residuals.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = murder ~ unrate, data = dd)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-37.977 -16.070  -5.972   6.820  77.749 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  89.0559     4.6885   18.99   <2e-16 ***\nunrate       -0.9073     0.6925   -1.31    0.192    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 23.93 on 202 degrees of freedom\nMultiple R-squared:  0.008426,\tAdjusted R-squared:  0.003517 \nF-statistic: 1.717 on 1 and 202 DF,  p-value: 0.1916\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nres.fit <- ts(residuals(fit.reg), start = c(2006, 1), frequency = 12)\nggtsdisplay(res.fit)\n```\n\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggtsdisplay(res.fit %>% diff())\n```\n\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n:::\n\n\nWe will try the following parameters:\n\n-   p: 1, 2, 4\n-   d: 0, 1\n-   q: 1\n\n\n::: {.cell}\n\n:::\n\n\n### Model Selection and Diagnostics\n\n#### Minimum AIC\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> p </th>\n   <th style=\"text-align:right;\"> d </th>\n   <th style=\"text-align:right;\"> q </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> AICc </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1723.056 </td>\n   <td style=\"text-align:right;\"> 1732.996 </td>\n   <td style=\"text-align:right;\"> 1723.177 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Minimum BIC\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> p </th>\n   <th style=\"text-align:right;\"> d </th>\n   <th style=\"text-align:right;\"> q </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> AICc </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1723.056 </td>\n   <td style=\"text-align:right;\"> 1732.996 </td>\n   <td style=\"text-align:right;\"> 1723.177 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Minimum AICc\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> p </th>\n   <th style=\"text-align:right;\"> d </th>\n   <th style=\"text-align:right;\"> q </th>\n   <th style=\"text-align:right;\"> AIC </th>\n   <th style=\"text-align:right;\"> BIC </th>\n   <th style=\"text-align:right;\"> AICc </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1723.056 </td>\n   <td style=\"text-align:right;\"> 1732.996 </td>\n   <td style=\"text-align:right;\"> 1723.177 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nIt is clear that the best model is one with parameters $p=1, d=1, q=1$. We now check the model diagnostics.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n#### Fitted vs. Actual\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n### Cross Validation\n\n### Forecasting\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\nAdding unemployment rate resulted in little change from the previous model, suggesting that the two are not related.  \n\n## Robbery \\~ Unemployment Rate\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> month </th>\n   <th style=\"text-align:right;\"> robbery </th>\n   <th style=\"text-align:right;\"> unrate </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-01-01 </td>\n   <td style=\"text-align:right;\"> 1072 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-02-01 </td>\n   <td style=\"text-align:right;\"> 890 </td>\n   <td style=\"text-align:right;\"> 5.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-03-01 </td>\n   <td style=\"text-align:right;\"> 1081 </td>\n   <td style=\"text-align:right;\"> 4.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-04-01 </td>\n   <td style=\"text-align:right;\"> 838 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-05-01 </td>\n   <td style=\"text-align:right;\"> 1063 </td>\n   <td style=\"text-align:right;\"> 4.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2006-06-01 </td>\n   <td style=\"text-align:right;\"> 1143 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\nThere looks to be some relation between these two variables, with the spike in 2020 in unemployment rate being at the same time as the low arrest rate, though we should fit a model to see if this relationship is substantial.\n\n### Fitting Using VARSelect\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n$selection\nAIC(n)  HQ(n)  SC(n) FPE(n) \n     3      3      3      3 \n\n$criteria\n                 1           2           3           4           5           6\nAIC(n)    8.811450    8.653570    8.542288    8.559735    8.554125    8.545074\nHQ(n)     8.866017    8.735420    8.651422    8.696153    8.717826    8.736058\nSC(n)     8.946207    8.855705    8.811802    8.896628    8.958396    9.016724\nFPE(n) 6710.718932 5730.792125 5127.543707 5218.254569 5189.751973 5143.950006\n                 7           8           9          10\nAIC(n)    8.576251    8.582496    8.587842    8.611119\nHQ(n)     8.794519    8.828047    8.860677    8.911237\nSC(n)     9.115279    9.188902    9.261627    9.352283\nFPE(n) 5308.169440 5343.126431 5373.917935 5503.165040\n```\n:::\n:::\n\n\nClearly p = 3 is a good parameter, we will also try VAR(1) in addition to VAR(3)\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n\nVAR Estimation Results:\n========================= \nEndogenous variables: robbery, unrate \nDeterministic variables: both \nSample size: 203 \nLog Likelihood: -1463.609 \nRoots of the characteristic polynomial:\n0.9406 0.2057\nCall:\nvars::VAR(y = dd[, c(2, 3)], p = 1, type = \"both\")\n\n\nEstimation results for equation robbery: \n======================================== \nrobbery = robbery.l1 + unrate.l1 + const + trend \n\n            Estimate Std. Error t value Pr(>|t|)    \nrobbery.l1   0.20839    0.06938   3.004  0.00301 ** \nunrate.l1   -8.72946    2.91948  -2.990  0.00314 ** \nconst      903.78956   82.66946  10.933  < 2e-16 ***\ntrend       -1.50118    0.17672  -8.495  4.6e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 96.96 on 199 degrees of freedom\nMultiple R-Squared: 0.5853,\tAdjusted R-squared: 0.579 \nF-statistic: 93.62 on 3 and 199 DF,  p-value: < 2.2e-16 \n\n\nEstimation results for equation unrate: \n======================================= \nunrate = robbery.l1 + unrate.l1 + const + trend \n\n             Estimate Std. Error t value Pr(>|t|)    \nrobbery.l1 -0.0002225  0.0005965  -0.373    0.710    \nunrate.l1   0.9379922  0.0251024  37.367   <2e-16 ***\nconst       0.7071527  0.7108128   0.995    0.321    \ntrend      -0.0012162  0.0015194  -0.800    0.424    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.8337 on 199 degrees of freedom\nMultiple R-Squared: 0.884,\tAdjusted R-squared: 0.8822 \nF-statistic: 505.5 on 3 and 199 DF,  p-value: < 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n         robbery  unrate\nrobbery 9401.877 -2.6771\nunrate    -2.677  0.6951\n\nCorrelation matrix of residuals:\n         robbery   unrate\nrobbery  1.00000 -0.03312\nunrate  -0.03312  1.00000\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nVAR Estimation Results:\n========================= \nEndogenous variables: robbery, unrate \nDeterministic variables: both \nSample size: 201 \nLog Likelihood: -1413.95 \nRoots of the characteristic polynomial:\n0.9289 0.6725 0.5582 0.5582 0.3277 0.3277\nCall:\nvars::VAR(y = dd[, c(2, 3)], p = 3, type = \"both\")\n\n\nEstimation results for equation robbery: \n======================================== \nrobbery = robbery.l1 + unrate.l1 + robbery.l2 + unrate.l2 + robbery.l3 + unrate.l3 + const + trend \n\n            Estimate Std. Error t value Pr(>|t|)    \nrobbery.l1   0.11734    0.06921   1.695  0.09162 .  \nunrate.l1  -12.27304    8.36123  -1.468  0.14377    \nrobbery.l2   0.19228    0.06843   2.810  0.00547 ** \nunrate.l2  -13.60799   13.07032  -1.041  0.29911    \nrobbery.l3   0.21359    0.07056   3.027  0.00281 ** \nunrate.l3   21.96316    8.28195   2.652  0.00867 ** \nconst      536.28009  113.03850   4.744 4.06e-06 ***\ntrend       -0.91250    0.21922  -4.162 4.74e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 91.34 on 193 degrees of freedom\nMultiple R-Squared: 0.6397,\tAdjusted R-squared: 0.6267 \nF-statistic: 48.96 on 7 and 193 DF,  p-value: < 2.2e-16 \n\n\nEstimation results for equation unrate: \n======================================= \nunrate = robbery.l1 + unrate.l1 + robbery.l2 + unrate.l2 + robbery.l3 + unrate.l3 + const + trend \n\n             Estimate Std. Error t value Pr(>|t|)    \nrobbery.l1 -0.0010184  0.0005781  -1.762  0.07971 .  \nunrate.l1   1.3043726  0.0698394  18.677  < 2e-16 ***\nrobbery.l2  0.0012443  0.0005716   2.177  0.03070 *  \nunrate.l2  -0.5625895  0.1091733  -5.153 6.31e-07 ***\nrobbery.l3  0.0010322  0.0005894   1.751  0.08149 .  \nunrate.l3   0.2039627  0.0691772   2.948  0.00359 ** \nconst      -0.9391336  0.9441842  -0.995  0.32115    \ntrend       0.0016859  0.0018311   0.921  0.35835    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nResidual standard error: 0.7629 on 193 degrees of freedom\nMultiple R-Squared: 0.9055,\tAdjusted R-squared: 0.9021 \nF-statistic: 264.2 on 7 and 193 DF,  p-value: < 2.2e-16 \n\n\n\nCovariance matrix of residuals:\n         robbery  unrate\nrobbery 8342.568 -8.0105\nunrate    -8.011  0.5821\n\nCorrelation matrix of residuals:\n        robbery unrate\nrobbery   1.000 -0.115\nunrate   -0.115  1.000\n```\n:::\n:::\n\n\n### Cross Validation\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-33-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 132.5029\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 131.5768\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.254941\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.948857\n```\n:::\n:::\n\n\nThe models are very close in performance, but it looks like VAR(3) is slightly better so we will forecast with that model. \n\n### Forecast\n\n::: {.cell}\n::: {.cell-output-display}\n![](arimax_sarimax_var_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\n\n## Controlled Substance Possession \\~ Marijuana Possession\n",
    "supporting": [
      "arimax_sarimax_var_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}