{"title":"Financial Time Series Models (ARCH/GARCH)","markdown":{"yaml":{"title":"Financial Time Series Models (ARCH/GARCH)","editor_options":{"chunk_output_type":"inline"},"toc":false},"headingText":"obtain data","containsRefs":false,"markdown":"\n\n```{r setup, include = FALSE}\nlibrary(plotly)\nlibrary(caret)\nlibrary(car)\nlibrary(ggplot2)\nlibrary(forecast)\nlibrary(gridExtra)\nlibrary(tseries)\nlibrary(quantmod)\nlibrary(fGarch)\nlibrary(FinTS)\n```\n\nAn interesting financial asset to model that would be useful in predicting crime rates would be CoreCivic (`CXW`), a company that owns and operates many private prisons throughout the United States. We will go through the model build process with this asset, considering financial time series models in addition to the traditional ones we have already seen. \n\n```{r}\ncxw <- getSymbols(\"CXW\", auto.assign = FALSE, from = \"2006-01-01\", to = \"2022-12-31\")\nchartSeries(cxw, theme = chartTheme(\"white\"), # Theme\n            bar.type = \"hlc\",  # High low close \n            up.col = \"green\",  # Up candle color\n            dn.col = \"red\")   # Down candle color\n```\n\n```{r}\nreturns <- cxw$CXW.Adjusted %>% diff()\nautoplot(returns) + ggtitle(\"CXW Returns\")\n```\n\nVolatility clustering is visible, an ARCH model may be appropriate.\n\n```{r}\ngrid.arrange(ggAcf(returns),\n             ggPacf(returns),\n             ncol = 1)\n\ngrid.arrange(ggAcf(abs(returns)),\n             ggPacf(returns^2),\n             ncol = 1)\n```\n\nCorrelation is visible in both plots, meaning conditional variation is present. \n\n```{r}\nArchTest(returns, lags = 1, demean = TRUE)\n```\n\nThe p-value is < 0.05, we reject the null hypothesis and can conclude that ARCH(1) effects are present in our data.\n\n```{r}\ngrid.arrange(ggAcf(returns),\n             ggPacf(returns),\n             ncol = 1)\n```\n\nThe first differenced series looks good, we will try the following parameters:\n\np: 1, 3\n\nd: 0, 1\n\nq: 1, 3\n\n```{r}\ni <- 1\n\ntemp <- data.frame()\nls <- matrix(rep(NA,6*17), nrow=17)\n\nfor(p in c(1, 3)){\n  for(q in c(1, 3)){\n    for(d in c(0, 1)){\n      if(p + d + q <= 8){\n        model <- Arima(cxw$CXW.Adjusted, order = c(p, d, q), include.drift = FALSE)\n        ls[i,] <- c(p, d, q, model$aic, model$bic, model$aicc)\n        i <- i +1\n      }\n    }\n  }\n}\n\ntemp <- as.data.frame(ls)\nnames(temp) <- c(\"p\",\"d\",\"q\",\"AIC\",\"BIC\",\"AICc\")\ntemp[which.min(temp$AIC),]\ntemp[which.min(temp$BIC),]\ntemp[which.min(temp$AICc),]\n\narima113 <- Arima(cxw$CXW.Adjusted, order = c(1, 1, 3), include.drift = FALSE)\narima.res <- arima113$residuals\nauto.arima(cxw$CXW.Adjusted)\n```\n\nAn ARIMA(1, 1, 3) model was clearly the best model, both when fitting by hand and when using auto.arima().\n\n```{r}\ngrid.arrange(ggAcf(arima.res^2), ggPacf(arima.res^2), ncol = 1)\n\nmodel <- list()\ncc <- 1\n\nfor (p in 1:7) {\n  for(q in 1:7) {\n    model[[cc]] <- garch(arima.res, order = c(q, p), trace = FALSE)\n    cc <- cc + 1\n  }\n}\n\nARCH_AIC <- sapply(model, AIC)\nmodel[[which(ARCH_AIC == min(ARCH_AIC))]]\nmin(ARCH_AIC)\nsummary(garch(arima.res, order = c(7, 1), trace = FALSE))\n```\n\n```{r}\nsummary(arima.fit <- Arima(cxw$CXW.Adjusted, order = c(1, 1, 3), include.drift = FALSE))\nsummary(final.fit <- garchFit(~garch(1, 7), arima.res, trace = FALSE))\n```\n\nGARCH(1, 7) is the best model. p-Values for the Ljung-Box test indicate that there is not enough evidence to reject the null hypothesis that there is no autocorrelation between residuals, meaning this is an adequate model. \n\n```{r}\npredict(final.fit, n.ahead = 100, plot = TRUE, table = FALSE)\nht <- final.fit@h.t\ndata <- data.frame(ht, index(cxw))\nggplot(data, aes(x = index(cxw), y = ht)) +\n  geom_line() +\n  ylab('Conditional Variance') + \n  xlab('Date') + \n  ggtitle(\"Volatality plot\")\n```\n\nPeriods of very high volatility can be seen, especially in the late 2010's.","srcMarkdownNoYaml":"\n\n```{r setup, include = FALSE}\nlibrary(plotly)\nlibrary(caret)\nlibrary(car)\nlibrary(ggplot2)\nlibrary(forecast)\nlibrary(gridExtra)\nlibrary(tseries)\nlibrary(quantmod)\nlibrary(fGarch)\nlibrary(FinTS)\n```\n\nAn interesting financial asset to model that would be useful in predicting crime rates would be CoreCivic (`CXW`), a company that owns and operates many private prisons throughout the United States. We will go through the model build process with this asset, considering financial time series models in addition to the traditional ones we have already seen. \n\n```{r}\n# obtain data\ncxw <- getSymbols(\"CXW\", auto.assign = FALSE, from = \"2006-01-01\", to = \"2022-12-31\")\nchartSeries(cxw, theme = chartTheme(\"white\"), # Theme\n            bar.type = \"hlc\",  # High low close \n            up.col = \"green\",  # Up candle color\n            dn.col = \"red\")   # Down candle color\n```\n\n```{r}\nreturns <- cxw$CXW.Adjusted %>% diff()\nautoplot(returns) + ggtitle(\"CXW Returns\")\n```\n\nVolatility clustering is visible, an ARCH model may be appropriate.\n\n```{r}\ngrid.arrange(ggAcf(returns),\n             ggPacf(returns),\n             ncol = 1)\n\ngrid.arrange(ggAcf(abs(returns)),\n             ggPacf(returns^2),\n             ncol = 1)\n```\n\nCorrelation is visible in both plots, meaning conditional variation is present. \n\n```{r}\nArchTest(returns, lags = 1, demean = TRUE)\n```\n\nThe p-value is < 0.05, we reject the null hypothesis and can conclude that ARCH(1) effects are present in our data.\n\n```{r}\ngrid.arrange(ggAcf(returns),\n             ggPacf(returns),\n             ncol = 1)\n```\n\nThe first differenced series looks good, we will try the following parameters:\n\np: 1, 3\n\nd: 0, 1\n\nq: 1, 3\n\n```{r}\ni <- 1\n\ntemp <- data.frame()\nls <- matrix(rep(NA,6*17), nrow=17)\n\nfor(p in c(1, 3)){\n  for(q in c(1, 3)){\n    for(d in c(0, 1)){\n      if(p + d + q <= 8){\n        model <- Arima(cxw$CXW.Adjusted, order = c(p, d, q), include.drift = FALSE)\n        ls[i,] <- c(p, d, q, model$aic, model$bic, model$aicc)\n        i <- i +1\n      }\n    }\n  }\n}\n\ntemp <- as.data.frame(ls)\nnames(temp) <- c(\"p\",\"d\",\"q\",\"AIC\",\"BIC\",\"AICc\")\ntemp[which.min(temp$AIC),]\ntemp[which.min(temp$BIC),]\ntemp[which.min(temp$AICc),]\n\narima113 <- Arima(cxw$CXW.Adjusted, order = c(1, 1, 3), include.drift = FALSE)\narima.res <- arima113$residuals\nauto.arima(cxw$CXW.Adjusted)\n```\n\nAn ARIMA(1, 1, 3) model was clearly the best model, both when fitting by hand and when using auto.arima().\n\n```{r}\ngrid.arrange(ggAcf(arima.res^2), ggPacf(arima.res^2), ncol = 1)\n\nmodel <- list()\ncc <- 1\n\nfor (p in 1:7) {\n  for(q in 1:7) {\n    model[[cc]] <- garch(arima.res, order = c(q, p), trace = FALSE)\n    cc <- cc + 1\n  }\n}\n\nARCH_AIC <- sapply(model, AIC)\nmodel[[which(ARCH_AIC == min(ARCH_AIC))]]\nmin(ARCH_AIC)\nsummary(garch(arima.res, order = c(7, 1), trace = FALSE))\n```\n\n```{r}\nsummary(arima.fit <- Arima(cxw$CXW.Adjusted, order = c(1, 1, 3), include.drift = FALSE))\nsummary(final.fit <- garchFit(~garch(1, 7), arima.res, trace = FALSE))\n```\n\nGARCH(1, 7) is the best model. p-Values for the Ljung-Box test indicate that there is not enough evidence to reject the null hypothesis that there is no autocorrelation between residuals, meaning this is an adequate model. \n\n```{r}\npredict(final.fit, n.ahead = 100, plot = TRUE, table = FALSE)\nht <- final.fit@h.t\ndata <- data.frame(ht, index(cxw))\nggplot(data, aes(x = index(cxw), y = ht)) +\n  geom_line() +\n  ylab('Conditional Variance') + \n  xlab('Date') + \n  ggtitle(\"Volatality plot\")\n```\n\nPeriods of very high volatility can be seen, especially in the late 2010's."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":false,"output-file":"financial_time_series_models.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","theme":"litera","fontsize":"1em","title":"Financial Time Series Models (ARCH/GARCH)","editor_options":{"chunk_output_type":"inline"}},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}