}, error = function(err) {
cat(a, b)
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
})
print(c("start", st + (i-1) + 1/12, "end: ", st + i))
}
n <- length(dd$month)
k <- 48
rmse1 <- matrix(NA, 132, 2)
rmse2 <- matrix(NA, 132, 2)
ts <- ts(dd[,c(2,3)], start = c(2012, 1), frequency = 12)
year <- c()
st <- tsp(ts)[1] + (k - 1)/12
for(i in 1:8) {
xtrain <- window(ts, end=st + i-1)
xtest <- window(ts, start=st + (i-1) + 1/12, end=st + i)
# first model
fit <- VAR(ts, p=1, type='both')
fcast <- predict(fit, n.ahead = 12)
frob<-fcast$fcst$robbery
funr<-fcast$fcst$unrate
ff<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 2 variables
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
})
# second model
fit2 <- VAR(ts, p=3, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
frob<-fcast2$fcst$robbery
funr<-fcast2$fcst$unrate
ff2<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 3 variables
year<-st + (i-1) + 1/12 #starting year
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
})
print(c("start", st + (i-1) + 1/12, "end: ", st + i))
}
n <- length(dd$month)
k <- 48
rmse1 <- matrix(NA, 132, 2)
rmse2 <- matrix(NA, 132, 2)
ts <- ts(dd[,c(2,3)], start = c(2012, 1), frequency = 12)
year <- c()
st <- tsp(ts)[1] + (k - 1)/12
for(i in 1:7) {
xtrain <- window(ts, end=st + i-1)
xtest <- window(ts, start=st + (i-1) + 1/12, end=st + i)
# first model
fit <- VAR(ts, p=1, type='both')
fcast <- predict(fit, n.ahead = 12)
frob<-fcast$fcst$robbery
funr<-fcast$fcst$unrate
ff<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 2 variables
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
})
# second model
fit2 <- VAR(ts, p=3, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
frob<-fcast2$fcst$robbery
funr<-fcast2$fcst$unrate
ff2<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 3 variables
year<-st + (i-1) + 1/12 #starting year
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
})
print(c("start", st + (i-1) + 1/12, "end: ", st + i))
}
View(rmse1)
n <- length(dd$month)
k <- 12
rmse1 <- matrix(NA, 132, 2)
rmse2 <- matrix(NA, 132, 2)
ts <- ts(dd[,c(2,3)], start = c(2012, 1), frequency = 12)
year <- c()
st <- tsp(ts)[1] + (k - 1)/12
for(i in 1:7) {
xtrain <- window(ts, end=st + i-1)
xtest <- window(ts, start=st + (i-1) + 1/12, end=st + i)
# first model
fit <- VAR(ts, p=1, type='both')
fcast <- predict(fit, n.ahead = 12)
frob<-fcast$fcst$robbery
funr<-fcast$fcst$unrate
ff<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 2 variables
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
})
# second model
fit2 <- VAR(ts, p=3, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
frob<-fcast2$fcst$robbery
funr<-fcast2$fcst$unrate
ff2<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 3 variables
year<-st + (i-1) + 1/12 #starting year
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
})
print(c("start", st + (i-1) + 1/12, "end: ", st + i))
}
n <- length(dd$month)
k <- 0
rmse1 <- matrix(NA, 132, 2)
rmse2 <- matrix(NA, 132, 2)
ts <- ts(dd[,c(2,3)], start = c(2012, 1), frequency = 12)
year <- c()
st <- tsp(ts)[1] + (k - 1)/12
for(i in 1:7) {
xtrain <- window(ts, end=st + i-1)
xtest <- window(ts, start=st + (i-1) + 1/12, end=st + i)
# first model
fit <- VAR(ts, p=1, type='both')
fcast <- predict(fit, n.ahead = 12)
frob<-fcast$fcst$robbery
funr<-fcast$fcst$unrate
ff<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 2 variables
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
})
# second model
fit2 <- VAR(ts, p=3, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
frob<-fcast2$fcst$robbery
funr<-fcast2$fcst$unrate
ff2<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 3 variables
year<-st + (i-1) + 1/12 #starting year
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
})
print(c("start", st + (i-1) + 1/12, "end: ", st + i))
}
n <- length(dd$month)
k <- 12
rmse1 <- matrix(NA, 132, 2)
rmse2 <- matrix(NA, 132, 2)
ts <- ts(dd[,c(2,3)], start = c(2012, 1), frequency = 12)
year <- c()
st <- tsp(ts)[1] + (k - 1)/12
for(i in 1:7) {
xtrain <- window(ts, end=st + i-1)
xtest <- window(ts, start=st + (i-1) + 1/12, end=st + i)
# first model
fit <- VAR(ts, p=1, type='both')
fcast <- predict(fit, n.ahead = 12)
frob<-fcast$fcst$robbery
funr<-fcast$fcst$unrate
ff<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 2 variables
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
})
# second model
fit2 <- VAR(ts, p=3, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
frob<-fcast2$fcst$robbery
funr<-fcast2$fcst$unrate
ff2<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 3 variables
year<-st + (i-1) + 1/12 #starting year
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
})
print(c("start", st + (i-1) + 1/12, "end: ", st + i))
}
n <- length(dd$month)
k <- 12
rmse1 <- matrix(NA, 132, 2)
rmse2 <- matrix(NA, 132, 2)
ts <- ts(dd[,c(2,3)], start = c(2012, 1), frequency = 12)
year <- c()
st <- tsp(ts)[1] + (k - 1)/12
for(i in 1:10) {
xtrain <- window(ts, end=st + i-1)
xtest <- window(ts, start=st + (i-1) + 1/12, end=st + i)
# first model
fit <- VAR(ts, p=1, type='both')
fcast <- predict(fit, n.ahead = 12)
frob<-fcast$fcst$robbery
funr<-fcast$fcst$unrate
ff<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 2 variables
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
})
# second model
fit2 <- VAR(ts, p=3, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
frob<-fcast2$fcst$robbery
funr<-fcast2$fcst$unrate
ff2<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 3 variables
year<-st + (i-1) + 1/12 #starting year
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
})
print(c("start", st + (i-1) + 1/12, "end: ", st + i))
}
View(rmse1)
ts <- ts(dd[,c(2,3)], start = c(2012, 1), frequency = 12)
n <- length(tss)
ts <- ts(dd[,c(2,3)], start = c(2012, 1), frequency = 12)
n <- length(ts)
k <- 12
rmse1 <- matrix(NA, 132, 2)
rmse2 <- matrix(NA, 132, 2)
year <- c()
st <- tsp(ts)[1] + (k - 1)/12
for(i in 1:10) {
xtrain <- window(ts, end=st + i-1)
xtest <- window(ts, start=st + (i-1) + 1/12, end=st + i)
# first model
fit <- VAR(ts, p=1, type='both')
fcast <- predict(fit, n.ahead = 12)
frob<-fcast$fcst$robbery
funr<-fcast$fcst$unrate
ff<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 2 variables
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
})
# second model
fit2 <- VAR(ts, p=3, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
frob<-fcast2$fcst$robbery
funr<-fcast2$fcst$unrate
ff2<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 3 variables
year<-st + (i-1) + 1/12 #starting year
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
})
print(c("start", st + (i-1) + 1/12, "end: ", st + i))
}
n
ts <- ts(dd[,c(2,3)], start = c(2012, 1), frequency = 12)
n
ts <- ts(dd[,c(2,3)], start = c(2012, 1), frequency = 12)
n <- length(ts)
k <- 24
rmse1 <- matrix(NA, 132, 2)
rmse2 <- matrix(NA, 132, 2)
year <- c()
st <- tsp(ts)[1] + (k - 1)/12
for(i in 1:10) {
xtrain <- window(ts, end=st + i-1)
xtest <- window(ts, start=st + (i-1) + 1/12, end=st + i)
# first model
fit <- VAR(ts, p=1, type='both')
fcast <- predict(fit, n.ahead = 12)
frob<-fcast$fcst$robbery
funr<-fcast$fcst$unrate
ff<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 2 variables
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
})
# second model
fit2 <- VAR(ts, p=3, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
frob<-fcast2$fcst$robbery
funr<-fcast2$fcst$unrate
ff2<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 3 variables
year<-st + (i-1) + 1/12 #starting year
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
})
print(c("start", st + (i-1) + 1/12, "end: ", st + i))
}
tsp(ts)[1]
ts <- ts(dd[,c(2,3)], start = c(2006, 1), frequency = 12)
k <- 72
rmse1 <- matrix(NA, 132, 2)
rmse2 <- matrix(NA, 132, 2)
ts <- ts(dd[,c(2,3)], start = c(2006, 1), frequency = 12)
k <- 72
rmse1 <- matrix(NA, 132, 2)
rmse2 <- matrix(NA, 132, 2)
year <- c()
st <- tsp(ts)[1] + (k - 1)/12
for(i in 1:10) {
xtrain <- window(ts, end=st + i-1)
xtest <- window(ts, start=st + (i-1) + 1/12, end=st + i)
# first model
fit <- VAR(ts, p=1, type='both')
fcast <- predict(fit, n.ahead = 12)
frob<-fcast$fcst$robbery
funr<-fcast$fcst$unrate
ff<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 2 variables
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
})
# second model
fit2 <- VAR(ts, p=3, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
frob<-fcast2$fcst$robbery
funr<-fcast2$fcst$unrate
ff2<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 3 variables
year<-st + (i-1) + 1/12 #starting year
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
})
print(c("start", st + (i-1) + 1/12, "end: ", st + i))
}
ts <- ts(dd[,c(2,3)], start = c(2006, 1), frequency = 12)
k <- 72
rmse1 <- matrix(NA, 132, 2)
rmse2 <- matrix(NA, 132, 2)
year <- c()
st <- tsp(ts)[1] + (k - 1)/12
for(i in 1:11) {
xtrain <- window(ts, end=st + i-1)
xtest <- window(ts, start=st + (i-1) + 1/12, end=st + i)
# first model
fit <- VAR(ts, p=1, type='both')
fcast <- predict(fit, n.ahead = 12)
frob<-fcast$fcst$robbery
funr<-fcast$fcst$unrate
ff<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 2 variables
year<-st + (i-1) + 1/12 #starting year
ff<-ts(ff,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse1[c(a:b),]  <- sqrt((ff-xtest)^2)
})
# second model
fit2 <- VAR(ts, p=3, type='both')
fcast2 <- predict(fit2, n.ahead = 12)
frob<-fcast2$fcst$robbery
funr<-fcast2$fcst$unrate
ff2<-data.frame(frob[,1],funr[,1]) #collecting the forecasts for 3 variables
year<-st + (i-1) + 1/12 #starting year
ff2<-ts(ff2,start=c(year,1),frequency = 12)
a = 12*i-11
b= 12*i
tryCatch({
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
}, error = function(err) {
cat(a, b)
rmse2[c(a:b),]  <- sqrt((ff2-xtest)^2)
})
print(c("start", st + (i-1) + 1/12, "end: ", st + i))
}
View(rmse1)
yr = rep(c(2012:2022),each =12) #year
m = rep(paste0(1:12),11) #month
rmse1 <- data.frame(yr,m,rmse1)
rmse1$date <- as.Date(paste(rmse1$yr, rmse1$m, "01", sep = "-"))
names(rmse1) <- c("Year", "Month","robbery","unemployment", "Date")
rmse2 <- data.frame(yr,m,rmse2)
rmse2$date <- as.Date(paste(rmse2$yr, rmse2$m, "01", sep = "-"))
names(rmse2) <- c("Year", "Month","robbery","unemployment", "Date")
ggplot() +
geom_line(data = rmse1, aes(x = Date, y = robbery),color = "blue") +
geom_line(data = rmse2, aes(x = Date, y = robbery),color = "red") +
labs(
title = "CV RMSE for robbery",
x = "Date",
y = "RMSE",
guides(colour=guide_legend(title="Fit")))
ggplot() +
geom_line(data = rmse1, aes(x = Date, y = unemployment),color = "blue") +
geom_line(data = rmse2, aes(x = Date, y = unemployment),color = "red") +
labs(
title = "CV RMSE for heater",
x = "Date",
y = "RMSE",
guides(colour=guide_legend(title="Fit")))
mean(rmse1$heater)
mean(rmse2$heater)
mean(rmse1$ice_cream)
mean(rmse2$ice_cream)
View(rmse1)
mean(rmse1$robbery)
mean(rmse2$robbery)
mean(rmse1$unemployment)
mean(rmse2$unemployment)
ggplot() +
geom_line(data = rmse1, aes(x = Date, y = robbery),color = "blue") +
geom_line(data = rmse2, aes(x = Date, y = robbery),color = "red") +
labs(
title = "CV RMSE for robbery",
x = "Date",
y = "RMSE",
guides(colour=guide_legend(title="Fit")))
ggplot() +
geom_line(data = rmse1, aes(x = Date, y = unemployment),color = "blue") +
geom_line(data = rmse2, aes(x = Date, y = unemployment),color = "red") +
labs(
title = "CV RMSE for heater",
x = "Date",
y = "RMSE",
guides(colour=guide_legend(title="Fit")))
mean(rmse1$robbery)
mean(rmse2$robbery)
mean(rmse1$unemployment)
mean(rmse2$unemployment)
fit <- VAR(ts, p = 3, type = "both")
plot(forecast(fit, 24))
