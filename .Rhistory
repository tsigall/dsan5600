df <- arrest_data %>%
mutate(arrest_date = as.Date(arrest_date)) %>%
arrange(arrest_date)
df <- arrest_data %>%
mutate(arrest_date = as.Date(as.numeric(arrest_date))) %>%
arrange(arrest_date)
View(df)
df <- arrest_data %>%
mutate(arrest_date = as.numeric(arrest_date)) %>%
arrange(arrest_date)
df <- arrest_data %>%
mutate(arrest_date = as.Date(arrest_date)) %>%
arrange(arrest_date)
df <- arrest_data %>%
mutate(arrest_date = as.Date(arrest_date, na.rm)) %>%
arrange(arrest_date)
df <- arrest_data %>%
mutate(arrest_date = as.Date(arrest_date, na.rm = TRUE)) %>%
arrange(arrest_date)
df <- arrest_data %>%
mutate(arrest_date = ymd(arrest_date)) %>%
arrange(arrest_date)
df <- arrest_data %>%
mutate(arrest_date = mdy(arrest_date)) %>%
arrange(arrest_date)
crime_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(count = n())
View(crime_by_date)
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests")
p1
save(arrest_data, file = "arrest_data.Rdata")
arrest_data <- load("arrest_data.Rdata")
df <- arrest_data %>%
mutate(arrest_date = mdy(arrest_date)) %>%
arrange(arrest_date)
load("~/Repositories/dsan5600/arrest_data.Rdata")
load("arrest_data.Rdata")
load("arrest_data.Rdata")
df <- arrest_data %>%
mutate(arrest_date = mdy(arrest_date)) %>%
arrange(arrest_date)
crime_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(count = n())
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests")
p1
save(df, file = "arrest_data.Rdata")
load("arrest_data.Rdata")
crime_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(count = n())
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests")
p1
load("arrest_data.Rdata")
crime_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(count = n())
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests")
p1
library(reticulate)
library(tidyverse)
library(lubridate)
use_condaenv("r-env", required = TRUE)
crime_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(count = n())
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests")
p1
library(reticulate)
library(tidyverse)
library(lubridate)
use_condaenv("r-env", required = TRUE)
crime_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(count = n())
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests")
p1
library(reticulate)
library(tidyverse)
library(lubridate)
library(ggplot2)
use_condaenv("r-env", required = TRUE)
library(reticulate)
library(tidyverse)
library(lubridate)
library(ggplot2)
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element(line, color = "grey", size = 0.5)
)
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line() color = "grey", size = 0.5)
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5)
)
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = linewidth(color = "grey", size = 0.5)
)
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5)
)
p1
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.major = element_line(color = "grey", size = 0.2)
)
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
)
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
)
p1
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_continuous(breaks = seq(2006, 2023, by = 2))
p1
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_continuous(breaks = seq(by = 2))
p1
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(breaks = seq(by = 2))
p1
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(date_breaks = "1 year")
p1
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(date_breaks = "2 years")
p1
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(date_breaks = "2 years",
date_labels = "%b %Y")
p1
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(date_breaks = "2 years",
date_labels = "%Y")
p1
p1 <- ggplot(data = crime_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(date_breaks = "1 year",
date_labels = "%Y")
p1
library(reticulate)
library(tidyverse)
library(lubridate)
library(ggplot2)
gglagplot(crime_by_date)
library(reticulate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(forecast)
gglagplot(crime_by_date)
gglagplot(crime_by_date, do.lines = FALSE)
gglagplot(crime_by_date, do.lines = FALSE, lags = 1)
gglagplot(crime_by_date$count, do.lines = FALSE, lags = 1)
gglagplot(crime_by_date$count, do.lines = FALSE, lags = 12)
gglagplot(crime_by_date$count, do.lines = TRUE, lags = 12)
gglagplot(crime_by_date$count, do.lines = FALSE, lags = 12)
gglagplot(crime_by_date$count, do.lines = FALSE, lags = 12) +
scale_x_continuous(breaks = seq(by(20000)))
gglagplot(crime_by_date$count, do.lines = FALSE, lags = 12) +
scale_x_continuous(breaks = seq(by = 20000))
gglagplot(crime_by_date$count, do.lines = FALSE, lags = 12) +
scale_x_binned(breaks = seq(by = 20000))
gglagplot(crime_by_date$count, do.lines = FALSE, lags = 12) +
scale_x_discrete(breaks = seq(by = 20000))
gglagplot(crime_by_date$count, do.lines = FALSE, lags = 1)
gglagplot(crime_by_date$count, do.lines = FALSE, lags = 1) +
scale_x_discrete(breaks = seq(by = 20000))
autoplot(crime_by_date)
autoplot(crime_by_date$count)
autoplot(ts(crime_by_date))
autoplot(ts(crime_by_date$count))
arrests_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(count = n())
arrest_ts <- ts(arrests_by_date, start = c(2006, 1), frequency = 12)
View(arrest_ts)
View(arrests_by_date)
arrest_ts
arrests_ts <- ts(arrests_by_date$count, start = c(2006, 1), frequency = 12)
autoplot(arrest_ts)
autoplot(arrests_ts)
gglagplot(arrests_ts, do.lines = FALSE, lags = 1) +
scale_x_discrete(breaks = seq(by = 20000))
gglagplot(arrests_ts, do.lines = FALSE, lags = 1)
gglagplot(arrests_ts, do.lines = FALSE, lags = 12)
gglagplot(arrests_ts, do.lines = FALSE)
gglagplot(arrests_ts, do.lines = FALSE, lag = 12)
gglagplot(arrests_ts, do.lines = FALSE, lag = 12) +
scale_y_continuous()
gglagplot(arrests_ts, do.lines = FALSE, lag = 12) +
scale_y_continuous() +
scale_x_continuous()
gglagplot(arrests_ts, do.lines = FALSE, lag = 12) +
scale_y_continuous(NULL) +
scale_x_continuous()
gglagplot(arrests_ts, do.lines = FALSE, lag = 12) +
scale_y_continuous() +
scale_x_continuous(breaks = seq(by = 20000))
gglagplot(arrests_ts, do.lines = FALSE, lag = 12) +
scale_y_continuous(breaks = seq(by = 20000)) +
scale_x_continuous(breaks = seq(by = 20000))
gglagplot(arrests_ts, do.lines = FALSE, lag = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
arrests_ts <- ts(arrests_by_date$count, start = c(2006, 1), frequency = 12)
autoplot(arrests_ts)
gglagplot(arrests_ts, do.lines = FALSE, lag = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
autoplot(arrests_ts)
gglagplot(arrests_ts, do.lines = FALSE, lag = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
autoplot(arrests_ts)
p1 <- ggplot(data = arrests_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(date_breaks = "1 year",
date_labels = "%Y")
p1
arrests_ts <- ts(arrests_by_date$count, start = c(2006, 1), frequency = 12)
gglagplot(arrests_ts, do.lines = FALSE, lag = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(TSstudio)
ts_lags(arrests_ts, lags(12, 18, 24, 30, 36))
ts_lags(arrests_ts, lags = c(12, 18, 24, 30, 36))
ts_lags(arrests_ts, lags = c(12, 24, 36, 48))
ts_lags(arrests_ts, lags = c(12, 24, 36, 48)) %>%
layout(title = "Lags",
xaxis = list(title = "test"))
ts_lags(arrests_ts, lags = c(12, 24, 36, 48)) %>%
layout(title = "Lags",
xaxis = list(title = "test"))
ts_lags(arrests_ts, lags = c(12, 24, 36, 48)) %>%
layout(title = "Lags")
ts_lags(arrests_ts, lags = c(12, 24, 36, 48))
ts_lags(arrests_ts, lags = c(12, 24, 36, 48), title(main = "Lags"))
ts_lags(arrests_ts, lags = c(12, 24, 36, 48)) %>%
layout(title = "Lags")
ts_lags(arrests_ts, lags = c(12, 24, 36, 48))
p1 <- ts_lags(arrests_ts, lags = c(12, 24, 36, 48))
ts_lags(arrests_ts, lags = c(12, 24, 36, 48))
ts_lags(arrests_ts, lags = 1:12
ts_lags(arrests_ts, lags = 1:12)
ts_lags(arrests_ts, lags = c(12, 24, 36, 48))
decompose(arrests_ts, "multiplicative")
plot(decompose(arrests_ts, "multiplicative"))
plot(decompose(arrests_ts, "multiplicative"))
plot(decompose(arrests_ts, "additive"))
plot(decompose(arrests_ts, "multiplicative"))
plot(decompose(arrests_ts, "additive"))
library(reticulate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(forecast)
library(TSstudio)
load("arrest_data.Rdata")
arrests_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(count = n())
p1 <- ggplot(data = arrests_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(date_breaks = "1 year",
date_labels = "%Y")
p1
arrests_ts <- ts(arrests_by_date$count, start = c(2006, 1), frequency = 12)
ts_lags(arrests_ts, lags = 1:12)
arrests_ts <- ts(arrests_by_date$count, start = c(2006, 1), frequency = 12)
ts_lags(arrests_ts, lags = 1:12)
arrests_ts <- ts(arrests_by_date$count, start = c(2006, 1), frequency = 12)
ts_lags(arrests_ts, lags = 1:12)
ts_lags(arrests_ts, lags = c(12, 24, 36, 48))
plot(decompose(arrests_ts, "multiplicative"))
plot(arrests_by_date)
plot(as.ts(arrests_by_date))
plot(arrests_ts)
trend_arrests <- ma(arrests_ts, order = 12, center = T)
trend_arrests <- ma(arrests_ts, order = 12)
plot(arrests_ts)
lines(trend_arrests)
trend_arrests <- ma(arrests_ts, order = 12)
plot(arrests_ts)
lines(trend_arrests)
plot(trend_arrests)
trend_arrests <- ma(arrests_ts, order = 13)
trend_arrests <- ma(arrests_ts, order = 13)
plot(arrests_ts)
lines(trend_arrests)
plot(trend_arrests)
trend_arrests <- ma(arrests_ts, order = 12)
p1 <- plot(arrests_ts)
lines(trend_arrests)
plot(trend_arrests)
p1
trend_arrests <- ma(arrests_ts, order = 12)
plot(arrests_ts)
lines(trend_arrests)
plot(trend_arrests)
detrend_arrests <- arrests_ts / trend_arrests
plot(detrend_arrests)
detrend_arrests <- arrests_ts - trend_arrests
plot(detrend_arrests)
detrend_arrests <- arrests_ts / trend_arrests
plot(detrend_arrests)
trend_arrests <- ma(arrests_ts, order = 12)
plot(arrests_ts)
lines(trend_arrests)
plot(trend_arrests)
m_arrests <- t(matrix(data = detrend_arrests, nrow = 12))
seasonal_arrests <- colMeans(m_arrests, na.rm = TRUE)
plot(as.ts(rep(seasonal_arrests, 12)))
random_arrests <- arrests_ts / (trend_arrests * seasonal_arrests)
plot(as.ts(random_arrests)
random_arrests <- arrests_ts / (trend_arrests * seasonal_arrests)
plot(as.ts(random_arrests))
reconstructed_arrests <- trend_arrests * seasonal_arrests * random_arrests
plot(as.ts(reconstructed_arrests))
library(reticulate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(forecast)
library(TSstudio)
load("arrest_data.Rdata")
arrests_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(count = n())
p1 <- ggplot(data = arrests_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(date_breaks = "1 year",
date_labels = "%Y")
p1
arrests_ts <- ts(arrests_by_date$count, start = c(2006, 1), frequency = 12)
ts_lags(arrests_ts, lags = 1:12)
ts_lags(arrests_ts, lags = c(12, 24, 36, 48))
plot(decompose(arrests_ts, "multiplicative"))
ggAcf(arrests_ts) + ggtitle("ACF Plot for Annual New York City Arrests")
ggPacf(arrests_ts) + ggtitle("PACF Plot for Annual New York City Arrests")
ggAcf(arrests_ts, 100) + ggtitle("ACF Plot for Annual New York City Arrests")
ggPacf(arrests_ts, 100) + ggtitle("PACF Plot for Annual New York City Arrests")
library(reticulate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(forecast)
library(TSstudio)
load("arrest_data.Rdata")
arrests_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(count = n())
p1 <- ggplot(data = arrests_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(date_breaks = "1 year",
date_labels = "%Y")
p1
