summarize(total = n())
arrests_plot <- ggplot(data = arrests_by_date, aes(x = month, y = total)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests")
arrests_plot
arrests_by_crime <- df %>%
mutate(pd_desc = ifelse(str_detect(pd_desc, "ASSAULT"), "assault",
ifelse(str_detect(pd_desc, "ROBBERY"), "robbery",
ifelse(str_detect(pd_desc, "MARIJUANA, POSSESSION"), "marijuana_possession",
ifelse(str_detect(pd_desc, "MARIJUANA, SALE"), "marijuana_sale",
ifelse(str_detect(pd_desc, "CE,P|NCE, P"), "controlled_substance_possession",
ifelse(str_detect(pd_desc, "E,I|CE, I|E,S|E, S"), "controlled_substance_sale",
ifelse(str_detect(pd_desc, "MURDER,UNCLASSIFIED"), "murder",
ifelse(str_detect(pd_desc, "AUTO"), "motor_vehicle_theft",
ifelse(str_detect(pd_desc, "LARCENY"), "larceny", pd_desc)))))))))) %>%
group_by(pd_desc) %>%
summarize(total = n()) %>%
filter(str_detect(pd_desc, "assault|robbery|marijuana_possession|marijuana_sale|controlled|substance_possession|controlled_substance_sale|murder|motor_vehicle_theft|larceny"))
kable(arrests_by_crime)
arrests_by_crime
arrests_by_crime_detail <- df %>%
filter(str_detect(pd_desc, "ASSAULT|ROBBERY|MARIJUANA, POSSESSION|MARIJUANA, SALE|CE,P|NCE, PE,I|CE, I|E,S|E, S|MURDER,UNCLASSIFIED|AUTO|LARCENY")) %>% group_by(pd_desc) %>%
summarize(total = n())
arrests_by_crime_detail
arrests_by_crime <- df %>%
mutate(pd_desc = ifelse(str_detect(pd_desc, "ASSAULT"), "assault",
ifelse(str_detect(pd_desc, "ROBBERY"), "robbery",
ifelse(str_detect(pd_desc, "MARIJUANA, POSSESSION"), "marijuana_possession",
ifelse(str_detect(pd_desc, "MARIJUANA, SALE"), "marijuana_sale",
ifelse(str_detect(pd_desc, "CE,P|NCE, P"), "controlled_substance_possession",
ifelse(str_detect(pd_desc, "E,I|CE, I|E,S|E, S"), "controlled_substance_sale",
ifelse(str_detect(pd_desc, "MURDER,UNCLASSIFIED"), "murder",
ifelse(str_detect(pd_desc, "AUTO"), "motor_vehicle_theft",
ifelse(str_detect(pd_desc, "LARCENY"), "larceny", pd_desc)))))))))) %>%
filter(str_detect(pd_desc, "assault|robbery|marijuana_possession|marijuana_sale|controlled|substance_possession|controlled_substance_sale|murder|motor_vehicle_theft|larceny")) %>%
group_by(month = floor_date(arrest_date, "month"), pd_desc) %>%
summarize(count = n()) %>%
pivot_wider(names_from = pd_desc, values_from = count, values_fill = 0) %>%
ungroup()
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~murder,
name = "Murder",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~assault,
name = "Assault",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~robbery,
name = "Robbery",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~larceny,
name = "Larceny",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~motor_vehicle_theft,
name = "Motor Vehicle Theft",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~marijuana_possession,
name = "Marijuana Possession",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~marijuana_sale,
name = "Marijuana Sale",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~controlled_substance_possession,
name = "Controlled Substance Possession",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~controlled_substance_sale,
name = "Controlled Substance Sale/Intent",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Crime by Type",
xaxis = list(title = "",
tickvals = c("2006", "2010", "2014", "2018", "2022"),
ticktext = c("2006", "2010", "2014", "2018", "2022")),
yaxis = list(title = "Arrests"))
save(list = c("arrests_by_crime", "arrests_by_date"), file = "arrest_data.Rdata")
library(reticulate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(forecast)
library(TSstudio)
library(tseries)
library(gridExtra)
library(plotly)
load("arrest_data.Rdata")
recidivism <- read.csv("recidivism.csv")
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~assault,
name = "Assault",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Assault",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
library(reticulate)
library(tidyverse)
library(lubridate)
library(plotly)
library(kableExtra)
use_condaenv("r-env", required = TRUE)
load("raw_data.Rdata")
df <- df %>%
mutate(arrest_date = as.Date(arrest_date, format = "%m/%d/%Y"),
month = month(arrest_date),
year = year(arrest_date))
arrests_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(total = n())
arrests_plot <- ggplot(data = arrests_by_date, aes(x = month, y = total)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests")
ggplotly(arrests_plot)
arrests_by_crime <- df %>%
mutate(pd_desc = ifelse(str_detect(pd_desc, "ASSAULT"), "assault",
ifelse(str_detect(pd_desc, "ROBBERY"), "robbery",
ifelse(str_detect(pd_desc, "MARIJUANA, POSSESSION"), "marijuana_possession",
ifelse(str_detect(pd_desc, "MARIJUANA, SALE"), "marijuana_sale",
ifelse(str_detect(pd_desc, "CE,P|NCE, P"), "controlled_substance_possession",
ifelse(str_detect(pd_desc, "E,I|CE, I|E,S|E, S"), "controlled_substance_sale",
ifelse(str_detect(pd_desc, "MURDER,UNCLASSIFIED"), "murder",
ifelse(str_detect(pd_desc, "AUTO"), "motor_vehicle_theft",
ifelse(str_detect(pd_desc, "LARCENY"), "larceny", pd_desc)))))))))) %>%
group_by(pd_desc) %>%
summarize(total = n()) %>%
filter(str_detect(pd_desc, "assault|robbery|marijuana_possession|marijuana_sale|controlled|substance_possession|controlled_substance_sale|murder|motor_vehicle_theft|larceny"))
kable(arrests_by_crime)
arrests_by_crime
arrests_by_crime <- df %>%
mutate(pd_desc = ifelse(str_detect(pd_desc, "ASSAULT"), "assault",
ifelse(str_detect(pd_desc, "ROBBERY"), "robbery",
ifelse(str_detect(pd_desc, "MARIJUANA, POSSESSION"), "marijuana_possession",
ifelse(str_detect(pd_desc, "MARIJUANA, SALE"), "marijuana_sale",
ifelse(str_detect(pd_desc, "CE,P|NCE, P"), "controlled_substance_possession",
ifelse(str_detect(pd_desc, "E,I|CE, I|E,S|E, S"), "controlled_substance_sale",
ifelse(str_detect(pd_desc, "MURDER,UNCLASSIFIED"), "murder",
ifelse(str_detect(pd_desc, "AUTO"), "motor_vehicle_theft",
ifelse(str_detect(pd_desc, "LARCENY"), "larceny", pd_desc)))))))))) %>%
group_by(pd_desc) %>%
summarize(total = n()) %>%
filter(str_detect(pd_desc, "assault|robbery|marijuana_possession|marijuana_sale|controlled_substance_possession|controlled_substance_sale|murder|motor_vehicle_theft|larceny")) %>%
mutate(controlled_substance_possession_sale = if_else(pd_desc == "controlled_substance_possession",
"controlled_substance_sale",
"controlled_substance_possession_sale"))
kable(arrests_by_crime)
arrests_by_crime
arrests_by_crime <- df %>%
mutate(pd_desc = ifelse(str_detect(pd_desc, "ASSAULT"), "assault",
ifelse(str_detect(pd_desc, "ROBBERY"), "robbery",
ifelse(str_detect(pd_desc, "MARIJUANA, POSSESSION"), "marijuana_possession",
ifelse(str_detect(pd_desc, "MARIJUANA, SALE"), "marijuana_sale",
ifelse(str_detect(pd_desc, "CE,P|NCE, P"), "controlled_substance_possession",
ifelse(str_detect(pd_desc, "E,I|CE, I|E,S|E, S"), "controlled_substance_sale",
ifelse(str_detect(pd_desc, "MURDER,UNCLASSIFIED"), "murder",
ifelse(str_detect(pd_desc, "AUTO"), "motor_vehicle_theft",
ifelse(str_detect(pd_desc, "LARCENY"), "larceny", pd_desc)))))))))) %>%
group_by(pd_desc) %>%
summarize(total = n()) %>%
filter(str_detect(pd_desc, "assault|robbery|marijuana_possession|marijuana_sale|controlled_substance_possession|controlled_substance_sale|murder|motor_vehicle_theft|larceny")) %>%
arrests_by_crime <- rbind(arrests_by_crime, data.frame(pd_desc = controlled_substance_possession_sale,
total = controlled_substance_possession + controlled_substance_sale))
arrests_by_crime <- df %>%
mutate(pd_desc = ifelse(str_detect(pd_desc, "ASSAULT"), "assault",
ifelse(str_detect(pd_desc, "ROBBERY"), "robbery",
ifelse(str_detect(pd_desc, "MARIJUANA, POSSESSION"), "marijuana_possession",
ifelse(str_detect(pd_desc, "MARIJUANA, SALE"), "marijuana_sale",
ifelse(str_detect(pd_desc, "CE,P|NCE, P"), "controlled_substance_possession",
ifelse(str_detect(pd_desc, "E,I|CE, I|E,S|E, S"), "controlled_substance_sale",
ifelse(str_detect(pd_desc, "MURDER,UNCLASSIFIED"), "murder",
ifelse(str_detect(pd_desc, "AUTO"), "motor_vehicle_theft",
ifelse(str_detect(pd_desc, "LARCENY"), "larceny", pd_desc)))))))))) %>%
group_by(pd_desc) %>%
summarize(total = n()) %>%
filter(str_detect(pd_desc, "assault|robbery|marijuana_possession|marijuana_sale|controlled_substance_possession|controlled_substance_sale|murder|motor_vehicle_theft|larceny")) %>%
arrests_by_crime <- rbind(arrests_by_crime, data.frame(pd_desc = "controlled_substance_possession_sale",
"total" = arrests_by_crime$controlled_substance_possession + arrests_by_crime$controlled_substance_sale))
arrests_by_crime <- df %>%
mutate(pd_desc = ifelse(str_detect(pd_desc, "ASSAULT"), "assault",
ifelse(str_detect(pd_desc, "ROBBERY"), "robbery",
ifelse(str_detect(pd_desc, "MARIJUANA, POSSESSION"), "marijuana_possession",
ifelse(str_detect(pd_desc, "MARIJUANA, SALE"), "marijuana_sale",
ifelse(str_detect(pd_desc, "CE,P|NCE, P"), "controlled_substance_possession",
ifelse(str_detect(pd_desc, "E,I|CE, I|E,S|E, S"), "controlled_substance_sale",
ifelse(str_detect(pd_desc, "MURDER,UNCLASSIFIED"), "murder",
ifelse(str_detect(pd_desc, "AUTO"), "motor_vehicle_theft",
ifelse(str_detect(pd_desc, "LARCENY"), "larceny", pd_desc)))))))))) %>%
group_by(pd_desc) %>%
summarize(total = n()) %>%
filter(str_detect(pd_desc, "assault|robbery|marijuana_possession|marijuana_sale|controlled_substance_possession|controlled_substance_sale|murder|motor_vehicle_theft|larceny")) %>%
data.frame(pd_desc = "controlled_substance_possession_sale",
"total" = arrests_by_crime$controlled_substance_possession + arrests_by_crime$controlled_substance_sale)
sd
sd
d
sd
data.frame(pd_desc = "controlled_substance_possession_sale",
"total" = arrests_by_crime$controlled_substance_possession + arrests_by_crime$controlled_substance_sale)
data.frame(pd_desc = "controlled_substance_possession_sale",
total = arrests_by_crime$controlled_substance_possession + arrests_by_crime$controlled_substance_sale)
arrests_by_crime$controlled_substance_possession + arrests_by_crime$controlled_substance_sale
View(arrests_by_crime)
arrests_by_crime <- df %>%
mutate(pd_desc = ifelse(str_detect(pd_desc, "ASSAULT"), "assault",
ifelse(str_detect(pd_desc, "ROBBERY"), "robbery",
ifelse(str_detect(pd_desc, "MARIJUANA, POSSESSION"), "marijuana_possession",
ifelse(str_detect(pd_desc, "MARIJUANA, SALE"), "marijuana_sale",
ifelse(str_detect(pd_desc, "CE,P|NCE, P"), "controlled_substance_possession",
ifelse(str_detect(pd_desc, "E,I|CE, I|E,S|E, S"), "controlled_substance_sale",
ifelse(str_detect(pd_desc, "MURDER,UNCLASSIFIED"), "murder",
ifelse(str_detect(pd_desc, "AUTO"), "motor_vehicle_theft",
ifelse(str_detect(pd_desc, "LARCENY"), "larceny", pd_desc)))))))))) %>%
group_by(pd_desc) %>%
summarize(total = n()) %>%
filter(str_detect(pd_desc, "assault|robbery|marijuana_possession|marijuana_sale|controlled_substance_possession|controlled_substance_sale|murder|motor_vehicle_theft|larceny"))
data.frame(pd_desc = "controlled_substance_possession_sale",
total = arrests_by_crime$controlled_substance_possession + arrests_by_crime$controlled_substance_sale)
arrests_by_crime$controlled_substance_possession + arrests_by_crime$controlled_substance_sale
View(arrests_by_crime)
arrests_by_crime$pd_desc["controlled_substance_possession"]
data.frame(pd_desc = "controlled_substance_possession_sale",
total = arrests_by_crime$total["controlled_substance_possession",] + arrests_by_crime$controlled_substance_sale)
data.frame(pd_desc = "controlled_substance_possession_sale",
total = arrests_by_crime$total[1] + arrests_by_crime$controlled_substance_sale)
arrests_by_crime$total[1]
arrests_by_crime$total[4]
arrests_by_crime$total[arrests_by_crime$pd_desc = "controlled_substance_possession"]
arrests_by_crime$total[arrests_by_crime$pd_desc == "controlled_substance_possession"]
data.frame(pd_desc = "controlled_substance_possession_sale",
total = arrests_by_crime$total[arrests_by_crime$pd_desc == "controlled_substance_possession"] +
arrests_by_crime$total[arrests_by_crime$pd_desc == "controlled_substance_sale"])
data.frame(pd_desc = "marijuana_possession_sale",
total = arrests_by_crime$total[arrests_by_crime$pd_desc == "marijuanapossession"] +
arrests_by_crime$total[arrests_by_crime$pd_desc == "marijuana_sale"])
data.frame(pd_desc = "marijuana_possession_sale",
total = arrests_by_crime$total[arrests_by_crime$pd_desc == "marijuana_possession"] +
arrests_by_crime$total[arrests_by_crime$pd_desc == "marijuana_sale"])
library(reticulate)
library(tidyverse)
library(lubridate)
library(plotly)
library(kableExtra)
use_condaenv("r-env", required = TRUE)
load("raw_data.Rdata")
reticulate::repl_python()
df <- df %>%
mutate(arrest_date = as.Date(arrest_date, format = "%m/%d/%Y"),
month = month(arrest_date),
year = year(arrest_date))
arrests_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(total = n())
arrests_plot <- ggplot(data = arrests_by_date, aes(x = month, y = total)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests")
ggplotly(arrests_plot)
arrests_by_crime <- df %>%
mutate(pd_desc = ifelse(str_detect(pd_desc, "ASSAULT"), "assault",
ifelse(str_detect(pd_desc, "ROBBERY"), "robbery",
ifelse(str_detect(pd_desc, "MARIJUANA, POSSESSION"), "marijuana_possession",
ifelse(str_detect(pd_desc, "MARIJUANA, SALE"), "marijuana_sale",
ifelse(str_detect(pd_desc, "CE,P|NCE, P"), "controlled_substance_possession",
ifelse(str_detect(pd_desc, "E,I|CE, I|E,S|E, S"), "controlled_substance_sale",
ifelse(str_detect(pd_desc, "MURDER,UNCLASSIFIED"), "murder",
ifelse(str_detect(pd_desc, "AUTO"), "motor_vehicle_theft",
ifelse(str_detect(pd_desc, "LARCENY"), "larceny", pd_desc)))))))))) %>%
group_by(pd_desc) %>%
summarize(total = n()) %>%
filter(str_detect(pd_desc, "assault|robbery|marijuana_possession|marijuana_sale|controlled|substance_possession|controlled_substance_sale|murder|motor_vehicle_theft|larceny"))
kable(arrests_by_crime)
arrests_by_crime
arrests_by_crime_detail <- df %>%
filter(str_detect(pd_desc, "ASSAULT|ROBBERY|MARIJUANA, POSSESSION|MARIJUANA, SALE|CE,P|NCE, PE,I|CE, I|E,S|E, S|MURDER,UNCLASSIFIED|AUTO|LARCENY")) %>% group_by(pd_desc) %>%
summarize(total = n())
arrests_by_crime_detail
arrests_by_crime <- df %>%
mutate(pd_desc = ifelse(str_detect(pd_desc, "ASSAULT"), "assault",
ifelse(str_detect(pd_desc, "ROBBERY"), "robbery",
ifelse(str_detect(pd_desc, "MARIJUANA, POSSESSION"), "marijuana_possession",
ifelse(str_detect(pd_desc, "MARIJUANA, SALE"), "marijuana_sale",
ifelse(str_detect(pd_desc, "CE,P|NCE, P"), "controlled_substance_possession",
ifelse(str_detect(pd_desc, "E,I|CE, I|E,S|E, S"), "controlled_substance_sale",
ifelse(str_detect(pd_desc, "MURDER,UNCLASSIFIED"), "murder",
ifelse(str_detect(pd_desc, "AUTO"), "motor_vehicle_theft",
ifelse(str_detect(pd_desc, "LARCENY"), "larceny", pd_desc)))))))))) %>%
filter(str_detect(pd_desc, "assault|robbery|marijuana_possession|marijuana_sale|controlled|substance_possession|controlled_substance_sale|murder|motor_vehicle_theft|larceny")) %>%
group_by(month = floor_date(arrest_date, "month"), pd_desc) %>%
summarize(count = n()) %>%
pivot_wider(names_from = pd_desc, values_from = count, values_fill = 0) %>%
ungroup()
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~murder,
name = "Murder",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~assault,
name = "Assault",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~robbery,
name = "Robbery",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~larceny,
name = "Larceny",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~motor_vehicle_theft,
name = "Motor Vehicle Theft",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~marijuana_possession,
name = "Marijuana Possession",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~marijuana_sale,
name = "Marijuana Sale",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~controlled_substance_possession,
name = "Controlled Substance Possession",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~controlled_substance_sale,
name = "Controlled Substance Sale/Intent",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Crime by Type",
xaxis = list(title = "",
tickvals = c("2006", "2010", "2014", "2018", "2022"),
ticktext = c("2006", "2010", "2014", "2018", "2022")),
yaxis = list(title = "Arrests"))
save(list = c("arrests_by_crime", "arrests_by_date"), file = "arrest_data.Rdata")
library(reticulate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(forecast)
library(TSstudio)
library(tseries)
library(gridExtra)
library(plotly)
library(reticulate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(forecast)
library(TSstudio)
library(tseries)
library(gridExtra)
library(plotly)
load("arrest_data.Rdata")
recidivism <- read.csv("recidivism.csv")
plot_ly(data = arrests_by_date,
x = ~month,
y = ~total,
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Arrests in New York City by Date",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
arrests_ts <- ts(arrests_by_date$total, start = c(2006, 1), frequency = 12)
ts_lags(arrests_ts, lags = 1:12)
ts_lags(arrests_ts, lags = c(12, 24, 36, 48))
plot(decompose(arrests_ts, "multiplicative"))
ggAcf(arrests_ts, 100) + ggtitle("ACF Plot for Annual New York City Arrests")
ggPacf(arrests_ts, 100) + ggtitle("PACF Plot for Annual New York City Arrests")
adf.test(arrests_ts)
detrend <- resid(lm(arrests_by_date$total ~ arrests_by_date$month, na.action = NULL))
difference <- diff(arrests_ts)
grid.arrange(autoplot(arrests_ts),
autoplot(as.ts(detrend)),
autoplot(difference),
ncol = 1)
ggtsdisplay(difference)
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~assault,
name = "Assault",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Assault",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
assault_ts <- ts(arrests_by_crime$assault, start = c(2006, 1), frequency = 12)
ts_lags(assault_ts, lags = 1:12)
ts_lags(assault_ts, lags = c(12, 24, 36, 48))
plot(decompose(assault_ts, "multiplicative"))
plot(decompose(assault_ts, "additive"))
plot(decompose(assault_ts, "additive"))
plot(decompose(assault_ts, "multiplicative"))
plot(decompose(assault_ts, "additive"))
plot(decompose(assault_ts, "multiplicative"))
plot(decompose(assault_ts, "additive"))
ggAcf(assault_ts, 100) + ggtitle("ACF Plot for Annual New York City Assault Arrests")
ggPacf(assault_ts, 100) + ggtitle("ACF Plot for Annual New York City Assault Arrests")
adf.test(assault_ts)
knitr::opts_chunk$set(echo = FALSE)
View(arrests_by_date)
View(arrests_by_crime)
detrend <- resid(lm(arrests_by_date$assault ~ arrests_by_date$month, na.action = NULL))
detrend <- resid(lm(arrests_by_crime$assault ~ arrests_by_date$month, na.action = NULL))
difference <- diff(assault)
detrend <- resid(lm(arrests_by_crime$assault ~ arrests_by_date$month, na.action = NULL))
difference <- diff(assault_ts)
grid.arrange(autoplot(assault_ts),
autoplot(as.ts(detrend)),
autoplot(difference),
ncol = 1)
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~controlled_substance_possession,
name = "Controlled Substance Possession",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Controlled Substance Possession",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
controlled_pos_ts <- ts(arrests_by_crime$controlled_substance_possession, start = c(2006, 1), frequency = 12)
ts_lags(controlled_pos_ts, lags = 1:12)
ts_lags(controlled_pos_ts, lags = c(12, 24, 36, 48))
plot(decompose(controlled_pos_ts, "additive"))
ggAcf(controlled_pos_ts, 100) + ggtitle("ACF Plot for Annual New York City Controled Substance Possession Arrests")
ggPcf(controlled_pos_ts, 100) + ggtitle("ACF Plot for Annual New York City Controled Substance Possession Arrests")
ggPacf(controlled_pos_ts, 100) + ggtitle("ACF Plot for Annual New York City Controled Substance Possession Arrests")
adf.test(controlled_pos_ts)
detrend <- resid(lm(arrests_by_crime$controlled_substance_possession ~ arrests_by_date$month, na.action = NULL))
difference <- diff(controlled_pos_ts)
grid.arrange(autoplot(controlled_pos_ts),
autoplot(as.ts(detrend)),
autoplot(difference),
ncol = 1)
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~controlled_substance_sale,
name = "Controlled Substance Sale",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Controlled Substance Sale",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
controlled_sale_ts <- ts(arrests_by_crime$controlled_substance_sale, start = c(2006, 1), frequency = 12)
ts_lags(controlled_sale_ts, lags = 1:12)
