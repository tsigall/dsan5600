arrests_by_crime <- df %>%
group_by(month = floor_date(arrest_date, "month"), pd_desc) %>%
summarize(count = n()) %>%
pivot_wider(names_from = pd_desc, values_from = count, values_fill = 0) %>%
ungroup()
View(arrests_by_date)
arrests_by_crime <- df %>%
group_by(month = floor_date(arrest_date, "month"), pd_desc) %>%
summarize(count = n()) %>%
pivot_wider(names_from = pd_desc, values_from = count, values_fill = 0) %>%
ungroup()%>%
mutate(month = as.Date(month, format = "%Y-%m"))
arrests_by_crime <- df %>%
group_by(month = floor_date(arrest_date, "month"), pd_desc) %>%
summarize(count = n()) %>%
pivot_wider(names_from = pd_desc, values_from = count, values_fill = 0) %>%
ungroup()
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~"ASSAULT 3",
name = "Assault 3",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~"MARIJUANA, POSSESSION 4 & 5",
name = "Marijuana Possesion 4, 5",
type = "scatter",
mode = "lines",
showlegend = TRUE)
arrests_by_crime <- df %>%
group_by(month = floor_date(arrest_date, "month"), pd_desc) %>%
summarize(count = n()) %>%
pivot_wider(names_from = pd_desc, values_from = count, values_fill = 0) %>%
ungroup() %>%
mutate(month = as.Date(month, format = "%Y-%m-%d"))
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~"ASSAULT 3",
name = "Assault 3",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~"MARIJUANA, POSSESSION 4 & 5",
name = "Marijuana Possesion 4, 5",
type = "scatter",
mode = "lines",
showlegend = TRUE)
arrests_by_crime <- df %>%
group_by(month = floor_date(arrest_date, "month"), pd_desc) %>%
summarize(count = n()) %>%
pivot_wider(names_from = pd_desc, values_from = count, values_fill = 0) %>%
ungroup() %>%
mutate(month = as.Date(month))
arrests_by_crime <- df %>%
group_by(month = floor_date(arrest_date, "month"), pd_desc) %>%
summarize(count = n()) %>%
pivot_wider(names_from = pd_desc, values_from = count, values_fill = 0) %>%
ungroup()
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~"ASSAULT 3",
name = "Assault 3",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~"MARIJUANA, POSSESSION 4 & 5",
name = "Marijuana Possesion 4, 5",
type = "scatter",
mode = "lines",
showlegend = TRUE)
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 3`,
name = "Assault 3",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`MARIJUANA, POSSESSION 4 & 5`,
name = "Marijuana Possesion 4, 5",
type = "scatter",
mode = "lines",
showlegend = TRUE)
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 3`,
name = "Assault 3",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`MARIJUANA, POSSESSION 4 & 5`,
name = "Marijuana Possesion 4, 5",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
# add_trace(data = arrests_by_crime,
#           x = ~month,
#           y = ~theft_of_services,
#           name = "Theft of Services, Unclassified",
#           type = "scatter",
#           mode = "lines",
#       showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`CONTROLLED SUBSTANCE, POSSESSION 7`,
name = "Controlled Substance Possession 7",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
# add_trace(data = arrests_by_crime,
#           x = ~month,
#           y = ~ny_state_unclassified,
#           name = "NY State Unclassified Violation",
#           type = "scatter",
#           mode = "lines",
#       showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 2,1,UNCLASSIFIED`,
name = "Assault 2, 1, or Unclassified",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Crime by Type",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 3`,
name = "Assault 3",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`MARIJUANA, POSSESSION 4 & 5`,
name = "Marijuana Possesion 4, 5",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
# add_trace(data = arrests_by_crime,
#           x = ~month,
#           y = ~theft_of_services,
#           name = "Theft of Services, Unclassified",
#           type = "scatter",
#           mode = "lines",
#       showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`CONTROLLED SUBSTANCE, POSSESSION 7`,
name = "Controlled Substance Possession 7",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
# add_trace(data = arrests_by_crime,
#           x = ~month,
#           y = ~ny_state_unclassified,
#           name = "NY State Unclassified Violation",
#           type = "scatter",
#           mode = "lines",
#       showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 2,1,UNCLASSIFIED`,
name = "Assault 2, 1, or Unclassified",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`LARCENY,PETIT FROM OPEN AREAS,UNCLASSIFIED`,
name = "Larceny, Petit",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Crime by Type",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 3`,
name = "Assault 3",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`MARIJUANA, POSSESSION 4 & 5`,
name = "Marijuana Possesion 4, 5",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
# add_trace(data = arrests_by_crime,
#           x = ~month,
#           y = ~theft_of_services,
#           name = "Theft of Services, Unclassified",
#           type = "scatter",
#           mode = "lines",
#       showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`CONTROLLED SUBSTANCE, POSSESSION 7`,
name = "Controlled Substance Possession 7",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
# add_trace(data = arrests_by_crime,
#           x = ~month,
#           y = ~ny_state_unclassified,
#           name = "NY State Unclassified Violation",
#           type = "scatter",
#           mode = "lines",
#       showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 2,1,UNCLASSIFIED`,
name = "Assault 2, 1, or Unclassified",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`LARCENY,PETIT FROM OPEN AREAS,UNCLASSIFIED`,
name = "Larceny, Petit",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`INTOXICATED DRIVING,ALCOHOL`,
name = "Larceny, Petit",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Crime by Type",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 3`,
name = "Assault 3",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`MARIJUANA, POSSESSION 4 & 5`,
name = "Marijuana Possesion 4, 5",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
# add_trace(data = arrests_by_crime,
#           x = ~month,
#           y = ~theft_of_services,
#           name = "Theft of Services, Unclassified",
#           type = "scatter",
#           mode = "lines",
#       showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`CONTROLLED SUBSTANCE, POSSESSION 7`,
name = "Controlled Substance Possession 7",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
# add_trace(data = arrests_by_crime,
#           x = ~month,
#           y = ~ny_state_unclassified,
#           name = "NY State Unclassified Violation",
#           type = "scatter",
#           mode = "lines",
#       showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 2,1,UNCLASSIFIED`,
name = "Assault 2, 1, or Unclassified",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`LARCENY,PETIT FROM OPEN AREAS,UNCLASSIFIED`,
name = "Larceny, Petit",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`INTOXICATED DRIVING,ALCOHOL`,
name = "Inoxicated Driving, Alcohol",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Crime by Type",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
arrests_by_crime <- df %>%
group_by(month = floor_date(arrest_date, "month"), pd_desc) %>%
summarize(count = n()) %>%
pivot_wider(names_from = pd_desc, values_from = count, values_fill = 0) %>%
ungroup()
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 3`,
name = "Assault 3",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`MARIJUANA, POSSESSION 4 & 5`,
name = "Marijuana Possesion 4, 5",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
# add_trace(data = arrests_by_crime,
#           x = ~month,
#           y = ~theft_of_services,
#           name = "Theft of Services, Unclassified",
#           type = "scatter",
#           mode = "lines",
#       showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`CONTROLLED SUBSTANCE, POSSESSION 7`,
name = "Controlled Substance Possession 7",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
# add_trace(data = arrests_by_crime,
#           x = ~month,
#           y = ~ny_state_unclassified,
#           name = "NY State Unclassified Violation",
#           type = "scatter",
#           mode = "lines",
#       showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 2,1,UNCLASSIFIED`,
name = "Assault 2, 1, or Unclassified",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`LARCENY,PETIT FROM OPEN AREAS,UNCLASSIFIED`,
name = "Larceny, Petit",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`INTOXICATED DRIVING,ALCOHOL`,
name = "Inoxicated Driving, Alcohol",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`WEAPONS, POSSESSION, ETC`,
name = "Weapons Possession",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Crime by Type",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
```{r arrests_by_crime, echo = FALSE}
library(reticulate)
library(tidyverse)
library(lubridate)
library(plotly)
library(kableExtra)
use_condaenv("r-env", required = TRUE)
reticulate::repl_python()
load("arrest_data.Rdata")
df<- df %>%
mutate(month = month(arrest_date),
year = year(arrest_date))
arrests_by_date <- df %>%
group_by(month = floor_date(arrest_date, "month")) %>%
summarize(total = n())
arrests_plot <- ggplot(data = arrests_by_date, aes(x = month, y = total)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests")
arrests_plot
arrests_by_crime <- df %>%
group_by(pd_desc) %>%
summarize(total = n()) %>%
arrange(desc(total))
kable(head(arrests_by_crime, 15))
arrests_by_crime <- df %>%
group_by(month = floor_date(arrest_date, "month"), pd_desc) %>%
summarize(count = n()) %>%
pivot_wider(names_from = pd_desc, values_from = count, values_fill = 0) %>%
ungroup()
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 3`,
name = "Assault 3",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`MARIJUANA, POSSESSION 4 & 5`,
name = "Marijuana Possesion 4, 5",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`CONTROLLED SUBSTANCE, POSSESSION 7`,
name = "Controlled Substance Possession 7",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 2,1,UNCLASSIFIED`,
name = "Assault 2, 1, or Unclassified",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`LARCENY,PETIT FROM OPEN AREAS,UNCLASSIFIED`,
name = "Larceny, Petit",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`INTOXICATED DRIVING,ALCOHOL`,
name = "Inoxicated Driving, Alcohol",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
add_trace(data = arrests_by_crime,
x = ~month,
y = ~`WEAPONS, POSSESSION, ETC`,
name = "Weapons Possession",
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Crime by Type",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
save(list = ("arrests_by_crime", "arrests_by_date"), fiele = "arrest_data.Rdata")
save(list = ("arrests_by_crime", "arrests_by_date"), file = "arrest_data.Rdata")
save(list = c("arrests_by_crime", "arrests_by_date"), file = "arrest_data.Rdata")
load("arrest_data.Rdata")
plot_ly(data = arrests_by_crime,
x = ~month,
y = ~`ASSAULT 3`,
name = "Assault 3",
type = "scatter",
mode = "lines",
showlegend = TRUE)
library(reticulate)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(forecast)
library(TSstudio)
library(tseries)
library(gridExtra)
ggplot(data = arrests_by_date, aes(x = month, y = count)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(date_breaks = "1 year",
date_labels = "%Y")
ggplot(data = arrests_by_date, aes(x = month, y = total)) +
geom_line() +
ggtitle("Arrests in New York City by Date") +
xlab("Arrest Date") +
ylab("Arrests") +
theme(
panel.grid.major = element_line(color = "grey", size = 0.5),
panel.grid.minor = element_line(color = "grey", size = 0.2)
) +
scale_x_date(date_breaks = "1 year",
date_labels = "%Y")
library(plotly)
plot_ly(data = arrests_by_date,
x = ~month,
y = ~total,
type = "scatter",
mode = "lines",
showlegend = TRUE) %>%
layout(title = "Crime by Type",
xaxis = list(title = ""),
yaxis = list(title = "Arrests"))
assault_3_ts <- ts(arrests_by_crime$`ASSAULT 3`, start = c(2006, 1), frequency = 12)
ts_lags(assault_3_ts, lags = 1:12)
